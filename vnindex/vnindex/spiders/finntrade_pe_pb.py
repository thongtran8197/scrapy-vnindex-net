import json

import scrapy
from datetime import datetime

from ..items import FinnTradeItem
import re

class FinnTradeSpider(scrapy.Spider):
    name = "finn_trade"
    custom_settings = {
        "ITEM_PIPELINES": {"vnindex.pipelines.FinnTradeSpiderPipeline": 1}
    }

    def start_requests(self):
        code = "PE"
        vn_codes = [
            "VN100",
            "VN30",
            "VNALL",
            "VNCOND",
            "VNCONS",
            "VNDIAMOND",
            "VNENE",
            "VNFIN",
            "VNFINLEAD",
            "VNFINSELECT",
            "VNHEAL",
            "VNIND",
            "VNINDEX",
            "VNIT",
            "VNMAT",
            "VNMID",
            "VNREAL",
            "VNSI",
            "VNSML",
            "VNUTI",
            "VNX50",
            "VNXALL"
        ]
        # vn_stock_codes = ['BDW', 'BGW', 'BLW', 'BNW', 'BTW', 'BWA', 'BWE', 'BWS', 'CLW', 'CMW', 'CTW', 'DNN', 'DNW', 'DVW', 'DWC', 'DWS', 'GDW', 'GLW', 'HDW', 'HGW', 'HPW', 'HWS', 'KHW', 'LAW', 'LDW', 'LKW', 'NAW', 'NBT', 'NBW', 'NDW', 'NLS', 'NNT', 'NQB', 'NQN', 'NQT', 'NS2', 'NSL', 'NTW', 'NVP', 'PJS', 'PMW', 'PWS', 'QNW', 'SII', 'STW', 'TAW', 'TDM', 'TDW', 'THN', 'THW', 'TNW', 'TOW', 'TQW', 'TVW', 'VAV', 'VCW', 'VLW', 'VPW', 'AGE', 'BMD', 'BRS', 'BTU', 'CDH', 'DLM', 'DNE', 'DTB', 'HEP', 'MBN', 'MCD', 'MDA', 'MLC', 'MND', 'MQN', 'MTH', 'MTL', 'MTV', 'NAU', 'NUE', 'QNU', 'SDV', 'SZE', 'THU', 'UCT', 'UDL', 'UMC', 'USD', 'VLP', 'ASP', 'CNG', 'GAS', 'HFC', 'MTG', 'PCG', 'PEG', 'PGC', 'PGD', 'PGS', 'PMG', 'PND', 'POV', 'PPY', 'PVG', 'VMG', 'AVC', 'BHA', 'BSA', 'BTP', 'CHP', 'DNA', 'DNC', 'DNH', 'DRL', 'DTE', 'DTK', 'EIC', 'GEG', 'GHC', 'GSM', 'HJS', 'HNA', 'HND', 'HPD', 'ISH', 'KHP', 'NBP', 'ND2', 'NED', 'NT2', 'NTH', 'PGV', 'PIC', 'POW', 'PPC', 'QPH', 'QTP', 'S4A', 'SBA', 'SBH', 'SBM', 'SEB', 'SHP', 'SJD', 'SP2', 'SVH', 'TBC', 'TDB', 'TMP', 'TTA', 'TTE', 'VCP', 'VPD', 'VSH', 'XMP', 'CMG', 'HIG', 'ITD', 'ONE', 'POT', 'TIE', 'VTK', 'CMT', 'FPT', 'HPT', 'PAI', 'PIA', 'SBD', 'SGT', 'SRA', 'SRB', 'VLA', 'ELC', 'ST8', 'CKV', 'ICT', 'KST', 'LTC', 'MFS', 'PMJ', 'PMT', 'SAM', 'SMT', 'TEL', 'TST', 'UNI', 'VAT', 'VGI', 'VIE', 'VTC', 'VTE', 'ARM', 'CFM', 'CNN', 'DCH', 'DKC', 'FTI', 'HEJ', 'HSA', 'INC', 'LPT', 'NAC', 'PPE', 'PVE', 'QNT', 'SDA', 'SDC', 'SHN', 'TV1', 'TV2', 'TV3', 'TV4', 'TVH', 'TVM', 'USC', 'VCT', 'VEF', 'VGV', 'VNC', 'VQC', 'VWS', 'AME', 'BTH', 'CAV', 'CJC', 'DDG', 'DHP', 'EMG', 'GEE', 'GEX', 'HEM', 'HLS', 'KIP', 'PPS', 'TBD', 'TGP', 'TYA', 'VTH', 'SFN', 'HDO', 'SCY', 'TSB', 'VBH', 'VEC', 'DLT', 'SMA', 'ILC', 'VCM', 'EMS', 'VTP', 'ACV', 'ASG', 'BLN', 'BSG', 'CAG', 'CIA', 'CLL', 'DL1', 'DNL', 'DOP', 'DVC', 'DVP', 'DXP', 'GIC', 'GMD', 'HAH', 'HCT', 'HHG', 'HHN', 'HHV', 'HMH', 'HNB', 'HRT', 'HTV', 'ILB', 'ILS', 'IST', 'MAC', 'MHC', 'MVN', 'NCT', 'NWT', 'PAP', 'PCT', 'PDN', 'PDV', 'PGT', 'PJC', 'PLO', 'PNP', 'PRC', 'PSC', 'PSP', 'PTH', 'PTS', 'PTT', 'RAT', 'SAC', 'SAS', 'SCS', 'SFI', 'SGN', 'SGP', 'SKG', 'SRT', 'STG', 'STS', 'TCD', 'TCL', 'TCO', 'TCW', 'TJC', 'TMS', 'TNP', 'TOS', 'TOT', 'TPS', 'TR1', 'TTZ', 'VGP', 'VGR', 'VIN', 'VLG', 'VMT', 'VNF', 'VNL', 'VNS', 'VNT', 'VSC', 'VSG', 'VSM', 'VTM', 'VTX', 'VXT', 'WCS', 'DUS', 'MPY', 'MQB', 'MTB', 'UPC', 'DSV', 'HHR', 'HLR', 'HTR', 'TSG', 'APL', 'CEG', 'CMK', 'CTB', 'CTT', 'DZM', 'FBC', 'FSO', 'FT1', 'IME', 'ITS', 'L62', 'L63', 'LCD', 'LLM', 'LM7', 'MA1', 'MIE', 'PMS', 'PVM', 'REE', 'SCO', 'SDK', 'SRF', 'TNI', 'UEM', 'VEA', 'ACC', 'ACE', 'ADP', 'BCC', 'BDT', 'BHC', 'BIG', 'BT6', 'BTD', 'BTN', 'BTS', 'CCM', 'CDG', 'CE1', 'CGV', 'CHC', 'CLH', 'CMD', 'CQT', 'CRC', 'CVT', 'CYC', 'DAC', 'DCR', 'DCT', 'DHA', 'DND', 'DNP', 'DPS', 'DSG', 'DTC', 'DVG', 'DXV', 'FIC', 'GAB', 'GKM', 'GMH', 'GMX', 'GND', 'HAM', 'HCC', 'HDA', 'HLY', 'HMR', 'HOM', 'HPP', 'HSP', 'HT1', 'HVX', 'KCE', 'KHL', 'KPF', 'L10', 'LBM', 'LCC', 'LGC', 'MCC', 'MCI', 'NAG', 'NAV', 'NHC', 'NNC', 'NO1', 'NXT', 'PCM', 'PTB', 'PTE', 'PX1', 'QHD', 'QNC', 'SCC', 'SCJ', 'SCL', 'SDN', 'SDY', 'SPI', 'TB8', 'TBX', 'TCK', 'TCR', 'TLT', 'TMX', 'TRT', 'TTB', 'TTC', 'TVA', 'TXM', 'VCS', 'VCX', 'VGC', 'VHL', 'VIH', 'VIT', 'VLB', 'VTA', 'VTS', 'VTV', 'VXB', 'X77', 'XMC', 'XMD', 'YBC', 'BAL', 'BBH', 'BBS', 'BPC', 'BTG', 'BXH', 'DPC', 'HBD', 'HPB', 'MCP', 'NHP', 'PBP', 'PBT', 'PMP', 'SDG', 'STP', 'TKA', 'TTP', 'VBC', 'CCP', 'CCR', 'CCT', 'CDN', 'CMP', 'CPI', 'CQN', 'DDH', 'DDM', 'GSP', 'ISG', 'NAP', 'NOS', 'PHP', 'PJT', 'PSN', 'PVP', 'PVT', 'QSP', 'SAL', 'SGS', 'SHC', 'SSG', 'SWC', 'TRS', 'TUG', 'VFC', 'VFR', 'VIP', 'VMS', 'VNA', 'VOS', 'VPA', 'VSA', 'VST', 'VTO', 'WTC', 'ACS', 'ALV', 'AMS', 'ATB', 'B82', 'BAX', 'BCE', 'BMN', 'BOT', 'C12', 'C32', 'C47', 'C4G', 'C69', 'C92', 'CC1', 'CC4', 'CCV', 'CDC', 'CDO', 'CDR', 'CH5', 'CHS', 'CI5', 'CID', 'CII', 'CIP', 'CK8', 'CMS', 'CNT', 'CT3', 'CT6', 'CTA', 'CTD', 'CTI', 'CTN', 'CTX', 'CVN', 'CX8', 'DC1', 'DC2', 'DC4', 'DCF', 'DFF', 'DGT', 'DIC', 'DID', 'DIH', 'DPG', 'DST', 'DTD', 'DTV', 'E12', 'E29', 'EME', 'EVG', 'FCN', 'FID', 'G36', 'GH3', 'GTS', 'H11', 'HAN', 'HAS', 'HBC', 'HC1', 'HC3', 'HCI', 'HEC', 'HFB', 'HID', 'HMS', 'HTE', 'HTI', 'HTN', 'HU1', 'HU3', 'HU4', 'HUB', 'HUT', 'HVH', 'ICC', 'ICG', 'ICI', 'ICN', 'KDM', 'KTT', 'L12', 'L14', 'L18', 'L35', 'L40', 'L43', 'L44', 'L45', 'L61', 'LCG', 'LCS', 'LG9', 'LHC', 'LIC', 'LIG', 'LM3', 'LM8', 'LMI', 'LO5', 'LQN', 'MCG', 'MCO', 'MDG', 'MEC', 'MES', 'MST', 'MVC', 'NDX', 'NHA', 'PC1', 'PCC', 'PDB', 'PEN', 'PHC', 'PHH', 'PLE', 'PQN', 'PSB', 'PSG', 'PTC', 'PTD', 'PTN', 'PTO', 'PVA', 'PVH', 'PVV', 'PVX', 'PXC', 'PXI', 'PXM', 'PXS', 'PXT', 'QCC', 'QTC', 'RCC', 'RCD', 'S12', 'S27', 'S55', 'S72', 'S74', 'S96', 'S99', 'SC5', 'SCG', 'SCI', 'SD1', 'SD2', 'SD3', 'SD4', 'SD5', 'SD6', 'SD7', 'SD8', 'SD9', 'SDB', 'SDD', 'SDJ', 'SDP', 'SDT', 'SDX', 'SHG', 'SIG', 'SJC', 'SJE', 'SJG', 'SJM', 'SVN', 'SZB', 'TA3', 'TA6', 'TA9', 'TBT', 'TDF', 'TDI', 'TED', 'THG', 'TKC', 'TL4', 'TLD', 'TNM', 'TS3', 'TTL', 'TVG', 'UDC', 'UDJ', 'UIC', 'V11', 'V12', 'V15', 'V21', 'VC1', 'VC2', 'VC5', 'VC6', 'VC7', 'VC9', 'VCC', 'VCG', 'VE1', 'VE2', 'VE3', 'VE4', 'VE8', 'VE9', 'VES', 'VHD', 'VHH', 'VIW', 'VMC', 'VNE', 'VPC', 'VSE', 'VSI', 'VVN', 'VW3', 'XDC', 'XDH', 'XLV', 'VVS', 'DMS', 'POB', 'PPT', 'PSH', 'TLP', 'PVB', 'BSR', 'OIL', 'PCN', 'PLX', 'PTX', 'PVO', 'TDG', 'SHE', 'MTS', 'PEQ', 'POS', 'PTV', 'PVC', 'PVD', 'PVS', 'PVY', 'CLX', 'LBC', 'PNG', 'TH1', 'TOP', 'BMF', 'COM', 'AAT', 'DAN', 'ABR', 'AMD', 'AST', 'BSC', 'BTT', 'CEN', 'CMV', 'DGW', 'FRT', 'GCB', 'GMA', 'HFX', 'HTC', 'HTM', 'KLF', 'KTC', 'LMH', 'MWG', 'PET', 'PIT', 'PIV', 'PSD', 'SFC', 'SID', 'THS', 'TMC', 'TNA', 'TTH', 'VTJ', 'ADG', 'CAR', 'ODE', 'VNX', 'CTC', 'DSN', 'GTT', 'HES', 'ONW', 'RGC', 'RIC', 'VNZ', 'YEG', 'CPH', 'BCV', 'BTV', 'DLD', 'DNT', 'DS3', 'DSD', 'DSP', 'DXL', 'HGT', 'HOT', 'MTC', 'PDC', 'STT', 'TCT', 'TSD', 'TSJ', 'TTT', 'VTD', 'VTG', 'VTR', 'HVN', 'MAS', 'NAS', 'VJC', 'DAH', 'OCH', 'SGH', 'SHX', 'VIR', 'VNG', 'CAB', 'ADC', 'ALT', 'BDB', 'BED', 'BST', 'DAD', 'DAE', 'EBS', 'ECI', 'EID', 'EPH', 'FHS', 'HEV', 'HTP', 'IBD', 'IHK', 'IN4', 'INN', 'LBE', 'NBE', 'PNC', 'PTP', 'QST', 'SAP', 'SED', 'SGD', 'SMN', 'STC', 'STH', 'TPH', 'VNB', 'VPR', 'BBM', 'BHK', 'BHN', 'BHP', 'BQB', 'BSD', 'BSH', 'BSL', 'BSP', 'BSQ', 'BTB', 'HAD', 'HAT', 'HBH', 'HLB', 'SAB', 'SB1', 'SBL', 'SMB', 'THB', 'WSB', 'HAV', 'HNR', 'VDL', 'VTL', 'A32', 'GTD', 'SSF', 'BEL', 'GLT', 'VTB', 'CSM', 'DRC', 'SRC', 'ACG', 'GTA', 'PID', 'SAV', 'TTF', 'XHC', 'AAM', 'ABT', 'ACL', 'AGF', 'ANV', 'APT', 'AVF', 'BAF', 'BHG', 'BLF', 'CAT', 'CMM', 'CMX', 'CNA', 'CPA', 'CTP', 'DMN', 'HAG', 'HNG', 'HVA', 'HVG', 'ICF', 'IDI', 'ILA', 'JOS', 'KHS', 'MLS', 'MPC', 'NGC', 'NHV', 'NSC', 'NSS', 'PAN', 'PCF', 'PSL', 'SEA', 'SJ1', 'SJF', 'SNC', 'SPD', 'SSC', 'TAN', 'TCJ', 'THP', 'TID', 'TS4', 'VHC', 'VLC', 'VNH', 'NAF', 'QHW', 'SCD', 'SKH', 'SKN', 'SKV', 'CMC', 'CTF', 'DAS', 'GGG', 'HAX', 'HHS', 'HTL', 'SVC', 'TMT', 'VMA', 'ADS', 'AG1', 'BDG', 'BMG', 'BVN', 'DCG', 'DM7', 'FTM', 'G20', 'GIL', 'GMC', 'HCB', 'HDM', 'HLT', 'HNI', 'HSM', 'HTG', 'HUG', 'LGM', 'M10', 'MGG', 'MNB', 'MPT', 'MSH', 'NDT', 'NJC', 'NTT', 'PNJ', 'PPH', 'PTG', 'SGI', 'STK', 'TCM', 'TDT', 'TET', 'TLI', 'TNG', 'TTG', 'TVT', 'VDN', 'VGG', 'VGT', 'VTI', 'X20', 'LIX', 'SPB', 'SVD', 'X26', 'XPH', 'ASA', 'DCS', 'DQC', 'NET', 'NHT', 'PAC', 'PHN', 'RAL', 'TLG', 'TV6', 'EVE', 'FBA', 'GDT', 'KMR', 'KSD', 'KTL', 'MBG', 'MHL', 'SHI', 'TMW', 'AFX', 'AGM', 'AGX', 'ANT', 'APF', 'ATA', 'ATS', 'BBC', 'BCF', 'BKH', 'BLT', 'BMV', 'BNA', 'C22', 'CAD', 'CAN', 'CBS', 'CCA', 'CET', 'CFV', 'CMF', 'CMN', 'DAT', 'DBC', 'EPC', 'FCC', 'FCS', 'FGL', 'FHN', 'FMC', 'GCF', 'GPC', 'HAF', 'HHC', 'HKB', 'HKT', 'HNF', 'HNM', 'HSL', 'IDP', 'IFS', 'KDC', 'KGM', 'KTS', 'LAF', 'LSS', 'MCF', 'MCH', 'MCM', 'MML', 'MSN', 'NCS', 'NDF', 'PRO', 'QNS', 'SAF', 'SBT', 'SEP', 'SGC', 'SGO', 'SLS', 'SPH', 'SPV', 'SSN', 'TAR', 'TFC', 'VCF', 'VHE', 'VHF', 'VLF', 'VNM', 'VOC', 'VSF', 'VSN', 'CLC', 'HJC', 'NST', 'PVI', 'AAV', 'AGG', 'API', 'ASM', 'BII', 'BVL', 'C21', 'CCI', 'CCL', 'CEO', 'CLG', 'CSC', 'D11', 'D2D', 'DIG', 'DRH', 'DTA', 'DXG', 'EFI', 'EIN', 'FDC', 'FIT', 'HAR', 'HD2', 'HD6', 'HDC', 'HDG', 'HLD', 'HPI', 'HPX', 'HQC', 'HTT', 'HU6', 'IDC', 'IDJ', 'IDV', 'IJC', 'ITA', 'ITC', 'KAC', 'KBC', 'KDH', 'LDG', 'LEC', 'LGL', 'LHG', 'MH3', 'NBB', 'NDN', 'NLG', 'NRC', 'NTB', 'NTC', 'NTL', 'NVL', 'NVT', 'OGC', 'PDR', 'PFL', 'PNT', 'PPI', 'PTL', 'PV2', 'PVL', 'PXA', 'PXL', 'QCG', 'RCL', 'SCR', 'SDU', 'SJS', 'SSH', 'STL', 'SZC', 'SZL', 'TDC', 'TDH', 'TEG', 'TIG', 'TIP', 'TIX', 'VC3', 'VCR', 'VHM', 'VIC', 'VNI', 'VPH', 'VRC', 'VRG', 'ABI', 'AIC', 'BHI', 'BIC', 'BLI', 'BMI', 'BVH', 'MIG', 'PGI', 'PTI', 'VNR', 'AAS', 'ABW', 'AGR', 'APG', 'APS', 'ART', 'BMS', 'BSI', 'BVS', 'CSI', 'CTS', 'DSC', 'EVS', 'FTS', 'HAC', 'HBS', 'HCM', 'IVS', 'MBS', 'ORS', 'PHS', 'PSI', 'SBS', 'SHS', 'SSI', 'TCI', 'TVB', 'TVS', 'VCI', 'VDS', 'VFS', 'VIG', 'VIX', 'VND', 'VUA', 'WSS', 'BCM', 'CIG', 'CKG', 'CRE', 'DLG', 'DLR', 'DTI', 'DXS', 'FIR', 'FLC', 'HD8', 'HRB', 'KHG', 'KOS', 'KSF', 'LAI', 'LSG', 'MGR', 'PLA', 'PVR', 'PWA', 'SGR', 'SIP', 'SNZ', 'SZG', 'TBH', 'TBR', 'TCH', 'THD', 'TN1', 'VHG', 'VPI', 'VRE', 'BCG', 'IBC', 'IPA', 'TGG', 'TIN', 'ABB', 'ACB', 'BAB', 'BID', 'BVB', 'CTG', 'EIB', 'EVF', 'HDB', 'KLB', 'LPB', 'MBB', 'MSB', 'NAB', 'NVB', 'OCB', 'PGB', 'SGB', 'SHB', 'SSB', 'STB', 'TCB', 'TPB', 'VAB', 'VBB', 'VCB', 'VIB', 'VPB', 'TVC', 'FUCTVGF3', 'FUCTVGF4', 'FUCVREIT', 'FUEDCMID', 'FUEKIVFS', 'E1VFVN30', 'FUEFCV50', 'FUEIP100', 'FUEKIV30', 'FUEMAV30', 'FUEMAVND', 'FUESSV30', 'FUESSV50', 'FUESSVFL', 'FUEVFVND', 'FUEVN100', 'PRE', 'DHC', 'GVT', 'HAP', 'HHP', 'SVI', 'SVT', 'VID', 'BFC', 'BT1', 'CPC', 'DCM', 'DHB', 'DOC', 'DPM', 'HAI', 'HSI', 'HVT', 'LAS', 'NFC', 'PMB', 'PSE', 'PSW', 'QBS', 'SFG', 'SPC', 'SVG', 'TSC', 'VAF', 'VFG', 'VPS', 'AAA', 'ABS', 'APC', 'APH', 'APP', 'BMP', 'BRC', 'BRR', 'CSV', 'DAG', 'DDV', 'DGC', 'DPR', 'DRG', 'DRI', 'DTT', 'GER', 'GVR', 'HCD', 'HII', 'HNP', 'HPH', 'HRC', 'IRC', 'LNC', 'LTG', 'NHH', 'NSG', 'NTP', 'PCE', 'PCH', 'PGN', 'PHR', 'PLC', 'PLP', 'RBC', 'RDP', 'RTB', 'SBR', 'SBV', 'SIV', 'TDP', 'TNC', 'TPC', 'TPP', 'TRC', 'VKP', 'VNP', 'VTZ', 'ACM', 'AMC', 'ATG', 'BGM', 'BKC', 'BMC', 'BMJ', 'CBI', 'CMI', 'DHM', 'FCM', 'HGM', 'HPM', 'KCB', 'KHD', 'KSB', 'KSH', 'KSQ', 'KSV', 'LCM', 'LMC', 'MGC', 'MIC', 'MIM', 'MSR', 'MTA', 'PAT', 'SQC', 'TNT', 'VBG', 'VCE', 'VIM', 'VPG', 'YBM', 'BCB', 'CLM', 'CST', 'HLC', 'MDC', 'MVB', 'NBC', 'TC6', 'TDN', 'THT', 'TMB', 'TVD', 'VDB', 'GLC', 'CKA', 'CKD', 'DFC', 'HLA', 'HMC', 'HSV', 'KLM', 'PAS', 'PEC', 'SHA', 'TKG', 'TKU', 'VGL', 'NSH', 'BCA', 'BVG', 'DTL', 'HMG', 'HPG', 'HSG', 'ITQ', 'KKC', 'KMT', 'KVC', 'MEL', 'NKG', 'POM', 'SMC', 'SSM', 'TDS', 'TIS', 'TLH', 'TMG', 'TNB', 'TNS', 'TTS', 'TVN', 'VCA', 'VDT', 'VGS', 'BKG', 'CAP', 'FRC', 'FRM', 'MDF', 'PIS', 'PRT', 'TQN', 'VIF', 'VTQ', 'CTR', 'FOC', 'FOX', 'ABC', 'TTN', 'TNH', 'TTD', 'VNY', 'VXP', 'AGP', 'BCP', 'BIO', 'CDP', 'CNC', 'DBD', 'DBM', 'DBT', 'DCL', 'DDN', 'DHD', 'DHG', 'DHN', 'DHT', 'DMC', 'DP1', 'DP2', 'DP3', 'DPH', 'DPP', 'DTG', 'DTH', 'DTP', 'DVM', 'DVN', 'HDP', 'IMP', 'LDP', 'MED', 'MKP', 'MKV', 'MTP', 'NDC', 'NDP', 'NTF', 'OPC', 'PBC', 'PMC', 'PPP', 'SPM', 'TRA', 'TVP', 'TW3', 'UPH', 'VDP', 'VET', 'VMD', 'YTC', 'AMP', 'AMV', 'JVC', 'MEF', 'BBT', 'MRF']
        # ogan_codes = vn_codes + vn_stock_codes
        ogan_code_mapping = {
    "Cung cấp nước sạch": [
        "BDW",
        "BGW",
        "BLW",
        "BNW",
        "BTW",
        "BWA",
        "BWE",
        "BWS",
        "CLW",
        "CMW",
        "CTW",
        "DNN",
        "DNW",
        "DVW",
        "DWC",
        "DWS",
        "GDW",
        "GLW",
        "HDW",
        "HGW",
        "HPW",
        "HWS",
        "KHW",
        "LAW",
        "LDW",
        "LKW",
        "NAW",
        "NBT",
        "NBW",
        "NDW",
        "NLS",
        "NNT",
        "NQB",
        "NQN",
        "NQT",
        "NS2",
        "NSL",
        "NTW",
        "NVP",
        "PJS",
        "PMW",
        "PWS",
        "QNW",
        "SII",
        "STW",
        "TAW",
        "TDM",
        "TDW",
        "THN",
        "THW",
        "TNW",
        "TOW",
        "TQW",
        "TVW",
        "VAV",
        "VCW",
        "VLW",
        "VPW"
    ],
    "Đa tiện ích": [
        "AGE",
        "BMD",
        "BRS",
        "BTU",
        "CDH",
        "DLM",
        "DNE",
        "DTB",
        "HEP",
        "MBN",
        "MCD",
        "MDA",
        "MLC",
        "MND",
        "MQN",
        "MTH",
        "MTL",
        "MTV",
        "NAU",
        "NUE",
        "QNU",
        "SDV",
        "SZE",
        "THU",
        "UCT",
        "UDL",
        "UMC",
        "USD",
        "VLP"
    ],
    "Phân phối khí đốt": [
        "ASP",
        "CNG",
        "GAS",
        "HFC",
        "MTG",
        "PCG",
        "PEG",
        "PGC",
        "PGD",
        "PGS",
        "PMG",
        "PND",
        "POV",
        "PPY",
        "PVG",
        "VMG"
    ],
    "Sản xuất và cung cấp điện truyền thống": [
        "AVC",
        "BHA",
        "BSA",
        "BTP",
        "CHP",
        "DNA",
        "DNC",
        "DNH",
        "DRL",
        "DTE",
        "DTK",
        "EIC",
        "GEG",
        "GHC",
        "GSM",
        "HJS",
        "HNA",
        "HND",
        "HPD",
        "ISH",
        "KHP",
        "NBP",
        "ND2",
        "NED",
        "NT2",
        "NTH",
        "PGV",
        "PIC",
        "POW",
        "PPC",
        "QPH",
        "QTP",
        "S4A",
        "SBA",
        "SBH",
        "SBM",
        "SEB",
        "SHP",
        "SJD",
        "SP2",
        "SVH",
        "TBC",
        "TDB",
        "TMP",
        "TTA",
        "TTE",
        "VCP",
        "VPD",
        "VSH",
        "XMP"
    ],
    "Công nghệ phần cứng": [
        "CMG",
        "HIG",
        "ITD",
        "ONE",
        "POT",
        "TIE",
        "VTK"
    ],
    "Công nghệ phần mềm": [
        "CMT",
        "FPT",
        "HPT",
        "PAI",
        "PIA",
        "SBD",
        "SGT",
        "SRA",
        "SRB",
        "VLA"
    ],
    "Dịch vụ internet": [
        "ELC"
    ],
    "Thiết bị điện tử văn phòng": [
        "ST8"
    ],
    "Thiết bị viễn thông": [
        "CKV",
        "ICT",
        "KST",
        "LTC",
        "MFS",
        "PMJ",
        "PMT",
        "SAM",
        "SMT",
        "TEL",
        "TST",
        "UNI",
        "VAT",
        "VGI",
        "VIE",
        "VTC",
        "VTE"
    ],
    "Các dịch vụ hỗ trợ kinh doanh": [
        "ARM",
        "CFM",
        "CNN",
        "DCH",
        "DKC",
        "FTI",
        "HEJ",
        "HSA",
        "INC",
        "LPT",
        "NAC",
        "PPE",
        "PVE",
        "QNT",
        "SDA",
        "SDC",
        "SHN",
        "TV1",
        "TV2",
        "TV3",
        "TV4",
        "TVH",
        "TVM",
        "USC",
        "VCT",
        "VEF",
        "VGV",
        "VNC",
        "VQC",
        "VWS"
    ],
    "Các linh kiện và thiết bị điện": [
        "AME",
        "BTH",
        "CAV",
        "CJC",
        "DDG",
        "DHP",
        "EMG",
        "GEE",
        "GEX",
        "HEM",
        "HLS",
        "KIP",
        "PPS",
        "TBD",
        "TGP",
        "TYA",
        "VTH"
    ],
    "Các nhà cung cấp công nghiệp": [
        "SFN"
    ],
    "Các phương tiện thương mại và xe thùng": [
        "HDO",
        "SCY"
    ],
    "Các thiết bị điện tử": [
        "TSB",
        "VBH",
        "VEC"
    ],
    "Công nghiệp đa ngành": [
        "DLT",
        "SMA"
    ],
    "Đào tạo nhân sự và việc làm": [
        "ILC",
        "VCM"
    ],
    "Dịch vụ bưu chính": [
        "EMS",
        "VTP"
    ],
    "Dịch vụ vận tải": [
        "ACV",
        "ASG",
        "BLN",
        "BSG",
        "CAG",
        "CIA",
        "CLL",
        "DL1",
        "DNL",
        "DOP",
        "DVC",
        "DVP",
        "DXP",
        "GIC",
        "GMD",
        "HAH",
        "HCT",
        "HHG",
        "HHN",
        "HHV",
        "HMH",
        "HNB",
        "HRT",
        "HTV",
        "ILB",
        "ILS",
        "IST",
        "MAC",
        "MHC",
        "MVN",
        "NCT",
        "NWT",
        "PAP",
        "PCT",
        "PDN",
        "PDV",
        "PGT",
        "PJC",
        "PLO",
        "PNP",
        "PRC",
        "PSC",
        "PSP",
        "PTH",
        "PTS",
        "PTT",
        "RAT",
        "SAC",
        "SAS",
        "SCS",
        "SFI",
        "SGN",
        "SGP",
        "SKG",
        "SRT",
        "STG",
        "STS",
        "TCD",
        "TCL",
        "TCO",
        "TCW",
        "TJC",
        "TMS",
        "TNP",
        "TOS",
        "TOT",
        "TPS",
        "TR1",
        "TTZ",
        "VGP",
        "VGR",
        "VIN",
        "VLG",
        "VMT",
        "VNF",
        "VNL",
        "VNS",
        "VNT",
        "VSC",
        "VSG",
        "VSM",
        "VTM",
        "VTX",
        "VXT",
        "WCS"
    ],
    "Dịch vụ xử lý nước thải, rác thải": [
        "DUS",
        "MPY",
        "MQB",
        "MTB",
        "UPC"
    ],
    "Đường sắt": [
        "DSV",
        "HHR",
        "HLR",
        "HTR",
        "TSG"
    ],
    "Máy công nghiệp": [
        "APL",
        "CEG",
        "CMK",
        "CTB",
        "CTT",
        "DZM",
        "FBC",
        "FSO",
        "FT1",
        "IME",
        "ITS",
        "L62",
        "L63",
        "LCD",
        "LLM",
        "LM7",
        "MA1",
        "MIE",
        "PMS",
        "PVM",
        "REE",
        "SCO",
        "SDK",
        "SRF",
        "TNI",
        "UEM",
        "VEA"
    ],
    "Thiết bị, vật liệu xây dựng": [
        "ACC",
        "ACE",
        "ADP",
        "BCC",
        "BDT",
        "BHC",
        "BIG",
        "BT6",
        "BTD",
        "BTN",
        "BTS",
        "CCM",
        "CDG",
        "CE1",
        "CGV",
        "CHC",
        "CLH",
        "CMD",
        "CQT",
        "CRC",
        "CVT",
        "CYC",
        "DAC",
        "DCR",
        "DCT",
        "DHA",
        "DND",
        "DNP",
        "DPS",
        "DSG",
        "DTC",
        "DVG",
        "DXV",
        "FIC",
        "GAB",
        "GKM",
        "GMH",
        "GMX",
        "GND",
        "HAM",
        "HCC",
        "HDA",
        "HLY",
        "HMR",
        "HOM",
        "HPP",
        "HSP",
        "HT1",
        "HVX",
        "KCE",
        "KHL",
        "KPF",
        "L10",
        "LBM",
        "LCC",
        "LGC",
        "MCC",
        "MCI",
        "NAG",
        "NAV",
        "NHC",
        "NNC",
        "NO1",
        "NXT",
        "PCM",
        "PTB",
        "PTE",
        "PX1",
        "QHD",
        "QNC",
        "SCC",
        "SCJ",
        "SCL",
        "SDN",
        "SDY",
        "SPI",
        "TB8",
        "TBX",
        "TCK",
        "TCR",
        "TLT",
        "TMX",
        "TRT",
        "TTB",
        "TTC",
        "TVA",
        "TXM",
        "VCS",
        "VCX",
        "VGC",
        "VHL",
        "VIH",
        "VIT",
        "VLB",
        "VTA",
        "VTS",
        "VTV",
        "VXB",
        "X77",
        "XMC",
        "XMD",
        "YBC"
    ],
    "Thùng, hộp, bao bì": [
        "BAL",
        "BBH",
        "BBS",
        "BPC",
        "BTG",
        "BXH",
        "DPC",
        "HBD",
        "HPB",
        "MCP",
        "NHP",
        "PBP",
        "PBT",
        "PMP",
        "SDG",
        "STP",
        "TKA",
        "TTP",
        "VBC"
    ],
    "Vận tải biển": [
        "CCP",
        "CCR",
        "CCT",
        "CDN",
        "CMP",
        "CPI",
        "CQN",
        "DDH",
        "DDM",
        "GSP",
        "ISG",
        "NAP",
        "NOS",
        "PHP",
        "PJT",
        "PSN",
        "PVP",
        "PVT",
        "QSP",
        "SAL",
        "SGS",
        "SHC",
        "SSG",
        "SWC",
        "TRS",
        "TUG",
        "VFC",
        "VFR",
        "VIP",
        "VMS",
        "VNA",
        "VOS",
        "VPA",
        "VSA",
        "VST",
        "VTO",
        "WTC"
    ],
    "Xây dựng, xây lắp": [
        "ACS",
        "ALV",
        "AMS",
        "ATB",
        "B82",
        "BAX",
        "BCE",
        "BMN",
        "BOT",
        "C12",
        "C32",
        "C47",
        "C4G",
        "C69",
        "C92",
        "CC1",
        "CC4",
        "CCV",
        "CDC",
        "CDO",
        "CDR",
        "CH5",
        "CHS",
        "CI5",
        "CID",
        "CII",
        "CIP",
        "CK8",
        "CMS",
        "CNT",
        "CT3",
        "CT6",
        "CTA",
        "CTD",
        "CTI",
        "CTN",
        "CTX",
        "CVN",
        "CX8",
        "DC1",
        "DC2",
        "DC4",
        "DCF",
        "DFF",
        "DGT",
        "DIC",
        "DID",
        "DIH",
        "DPG",
        "DST",
        "DTD",
        "DTV",
        "E12",
        "E29",
        "EME",
        "EVG",
        "FCN",
        "FID",
        "G36",
        "GH3",
        "GTS",
        "H11",
        "HAN",
        "HAS",
        "HBC",
        "HC1",
        "HC3",
        "HCI",
        "HEC",
        "HFB",
        "HID",
        "HMS",
        "HTE",
        "HTI",
        "HTN",
        "HU1",
        "HU3",
        "HU4",
        "HUB",
        "HUT",
        "HVH",
        "ICC",
        "ICG",
        "ICI",
        "ICN",
        "KDM",
        "KTT",
        "L12",
        "L14",
        "L18",
        "L35",
        "L40",
        "L43",
        "L44",
        "L45",
        "L61",
        "LCG",
        "LCS",
        "LG9",
        "LHC",
        "LIC",
        "LIG",
        "LM3",
        "LM8",
        "LMI",
        "LO5",
        "LQN",
        "MCG",
        "MCO",
        "MDG",
        "MEC",
        "MES",
        "MST",
        "MVC",
        "NDX",
        "NHA",
        "PC1",
        "PCC",
        "PDB",
        "PEN",
        "PHC",
        "PHH",
        "PLE",
        "PQN",
        "PSB",
        "PSG",
        "PTC",
        "PTD",
        "PTN",
        "PTO",
        "PVA",
        "PVH",
        "PVV",
        "PVX",
        "PXC",
        "PXI",
        "PXM",
        "PXS",
        "PXT",
        "QCC",
        "QTC",
        "RCC",
        "RCD",
        "S12",
        "S27",
        "S55",
        "S72",
        "S74",
        "S96",
        "S99",
        "SC5",
        "SCG",
        "SCI",
        "SD1",
        "SD2",
        "SD3",
        "SD4",
        "SD5",
        "SD6",
        "SD7",
        "SD8",
        "SD9",
        "SDB",
        "SDD",
        "SDJ",
        "SDP",
        "SDT",
        "SDX",
        "SHG",
        "SIG",
        "SJC",
        "SJE",
        "SJG",
        "SJM",
        "SVN",
        "SZB",
        "TA3",
        "TA6",
        "TA9",
        "TBT",
        "TDF",
        "TDI",
        "TED",
        "THG",
        "TKC",
        "TL4",
        "TLD",
        "TNM",
        "TS3",
        "TTL",
        "TVG",
        "UDC",
        "UDJ",
        "UIC",
        "V11",
        "V12",
        "V15",
        "V21",
        "VC1",
        "VC2",
        "VC5",
        "VC6",
        "VC7",
        "VC9",
        "VCC",
        "VCG",
        "VE1",
        "VE2",
        "VE3",
        "VE4",
        "VE8",
        "VE9",
        "VES",
        "VHD",
        "VHH",
        "VIW",
        "VMC",
        "VNE",
        "VPC",
        "VSE",
        "VSI",
        "VVN",
        "VW3",
        "XDC",
        "XDH",
        "XLV"
    ],
    "Xe tải": [
        "VVS"
    ],
    "Nhiên liệu thay thế": [
        "DMS",
        "POB",
        "PPT",
        "PSH",
        "TLP"
    ],
    "Ống dẫn dầu khí": [
        "PVB"
    ],
    "Thăm dò và sản xuất dầu khí": [
        "BSR",
        "OIL",
        "PCN",
        "PLX",
        "PTX",
        "PVO",
        "TDG"
    ],
    "Thiết bị năng lượng tái tạo": [
        "SHE"
    ],
    "Thiết bị, dịch vụ khai thác dầu mỏ": [
        "MTS",
        "PEQ",
        "POS",
        "PTV",
        "PVC",
        "PVD",
        "PVS",
        "PVY"
    ],
    "Bán buôn bán lẻ thực phẩm": [
        "CLX",
        "LBC",
        "PNG",
        "TH1",
        "TOP"
    ],
    "Bán lẻ đặc chủng": [
        "BMF",
        "COM"
    ],
    "Bán lẻ đồ may mặc": [
        "AAT"
    ],
    "Bán lẻ thuốc": [
        "DAN"
    ],
    "Bán lẻ tổng hợp": [
        "ABR",
        "AMD",
        "AST",
        "BSC",
        "BTT",
        "CEN",
        "CMV",
        "DGW",
        "FRT",
        "GCB",
        "GMA",
        "HFX",
        "HTC",
        "HTM",
        "KLF",
        "KTC",
        "LMH",
        "MWG",
        "PET",
        "PIT",
        "PIV",
        "PSD",
        "SFC",
        "SID",
        "THS",
        "TMC",
        "TNA",
        "TTH",
        "VTJ"
    ],
    "Các công ty truyền thông": [
        "ADG",
        "CAR",
        "ODE",
        "VNX"
    ],
    "Dịch vụ giải trí": [
        "CTC",
        "DSN",
        "GTT",
        "HES",
        "ONW",
        "RGC",
        "RIC",
        "VNZ",
        "YEG"
    ],
    "Dịch vụ tiêu dùng đặc chủng": [
        "CPH"
    ],
    "Du lịch": [
        "BCV",
        "BTV",
        "DLD",
        "DNT",
        "DS3",
        "DSD",
        "DSP",
        "DXL",
        "HGT",
        "HOT",
        "MTC",
        "PDC",
        "STT",
        "TCT",
        "TSD",
        "TSJ",
        "TTT",
        "VTD",
        "VTG",
        "VTR"
    ],
    "Hàng không chở khách": [
        "HVN",
        "MAS",
        "NAS",
        "VJC"
    ],
    "Khách sạn": [
        "DAH",
        "OCH",
        "SGH",
        "SHX",
        "VIR",
        "VNG"
    ],
    "Phát thanh truyền hình": [
        "CAB"
    ],
    "Xuất bản": [
        "ADC",
        "ALT",
        "BDB",
        "BED",
        "BST",
        "DAD",
        "DAE",
        "EBS",
        "ECI",
        "EID",
        "EPH",
        "FHS",
        "HEV",
        "HTP",
        "IBD",
        "IHK",
        "IN4",
        "INN",
        "LBE",
        "NBE",
        "PNC",
        "PTP",
        "QST",
        "SAP",
        "SED",
        "SGD",
        "SMN",
        "STC",
        "STH",
        "TPH",
        "VNB",
        "VPR"
    ],
    "Bia": [
        "BBM",
        "BHK",
        "BHN",
        "BHP",
        "BQB",
        "BSD",
        "BSH",
        "BSL",
        "BSP",
        "BSQ",
        "BTB",
        "HAD",
        "HAT",
        "HBH",
        "HLB",
        "SAB",
        "SB1",
        "SBL",
        "SMB",
        "THB",
        "WSB"
    ],
    "Chưng cất và bán rượu": [
        "HAV",
        "HNR",
        "VDL",
        "VTL"
    ],
    "Da giầy": [
        "A32",
        "GTD",
        "SSF"
    ],
    "Đồ điện tử tiêu dùng": [
        "BEL",
        "GLT",
        "VTB"
    ],
    "Lốp": [
        "CSM",
        "DRC",
        "SRC"
    ],
    "Nội thất": [
        "ACG",
        "GTA",
        "PID",
        "SAV",
        "TTF",
        "XHC"
    ],
    "Nông sản, thủy sản, đồn điền": [
        "AAM",
        "ABT",
        "ACL",
        "AGF",
        "ANV",
        "APT",
        "AVF",
        "BAF",
        "BHG",
        "BLF",
        "CAT",
        "CMM",
        "CMX",
        "CNA",
        "CPA",
        "CTP",
        "DMN",
        "HAG",
        "HNG",
        "HVA",
        "HVG",
        "ICF",
        "IDI",
        "ILA",
        "JOS",
        "KHS",
        "MLS",
        "MPC",
        "NGC",
        "NHV",
        "NSC",
        "NSS",
        "PAN",
        "PCF",
        "PSL",
        "SEA",
        "SJ1",
        "SJF",
        "SNC",
        "SPD",
        "SSC",
        "TAN",
        "TCJ",
        "THP",
        "TID",
        "TS4",
        "VHC",
        "VLC",
        "VNH"
    ],
    "Nước giải khát": [
        "NAF",
        "QHW",
        "SCD",
        "SKH",
        "SKN",
        "SKV"
    ],
    "Ô tô": [
        "CMC",
        "CTF",
        "DAS",
        "GGG",
        "HAX",
        "HHS",
        "HTL",
        "SVC",
        "TMT",
        "VMA"
    ],
    "Quần áo và đồ phụ kiện": [
        "ADS",
        "AG1",
        "BDG",
        "BMG",
        "BVN",
        "DCG",
        "DM7",
        "FTM",
        "G20",
        "GIL",
        "GMC",
        "HCB",
        "HDM",
        "HLT",
        "HNI",
        "HSM",
        "HTG",
        "HUG",
        "LGM",
        "M10",
        "MGG",
        "MNB",
        "MPT",
        "MSH",
        "NDT",
        "NJC",
        "NTT",
        "PNJ",
        "PPH",
        "PTG",
        "SGI",
        "STK",
        "TCM",
        "TDT",
        "TET",
        "TLI",
        "TNG",
        "TTG",
        "TVT",
        "VDN",
        "VGG",
        "VGT",
        "VTI",
        "X20"
    ],
    "Sản phẩm cá nhân": [
        "LIX",
        "SPB",
        "SVD",
        "X26",
        "XPH"
    ],
    "Sản phẩm gia dụng không lâu bền": [
        "ASA",
        "DCS",
        "DQC",
        "NET",
        "NHT",
        "PAC",
        "PHN",
        "RAL",
        "TLG",
        "TV6"
    ],
    "Sản phẩm gia dụng lâu bền": [
        "EVE",
        "FBA",
        "GDT",
        "KMR",
        "KSD",
        "KTL",
        "MBG",
        "MHL",
        "SHI",
        "TMW"
    ],
    "Sản phẩm thực phẩm": [
        "AFX",
        "AGM",
        "AGX",
        "ANT",
        "APF",
        "ATA",
        "ATS",
        "BBC",
        "BCF",
        "BKH",
        "BLT",
        "BMV",
        "BNA",
        "C22",
        "CAD",
        "CAN",
        "CBS",
        "CCA",
        "CET",
        "CFV",
        "CMF",
        "CMN",
        "DAT",
        "DBC",
        "EPC",
        "FCC",
        "FCS",
        "FGL",
        "FHN",
        "FMC",
        "GCF",
        "GPC",
        "HAF",
        "HHC",
        "HKB",
        "HKT",
        "HNF",
        "HNM",
        "HSL",
        "IDP",
        "IFS",
        "KDC",
        "KGM",
        "KTS",
        "LAF",
        "LSS",
        "MCF",
        "MCH",
        "MCM",
        "MML",
        "MSN",
        "NCS",
        "NDF",
        "PRO",
        "QNS",
        "SAF",
        "SBT",
        "SEP",
        "SGC",
        "SGO",
        "SLS",
        "SPH",
        "SPV",
        "SSN",
        "TAR",
        "TFC",
        "VCF",
        "VHE",
        "VHF",
        "VLF",
        "VNM",
        "VOC",
        "VSF",
        "VSN"
    ],
    "Thuốc lá": [
        "CLC",
        "HJC",
        "NST"
    ],
    "Các công ty bảo hiểm tổng hợp": [
        "PVI"
    ],
    "Các công ty đầu cơ và phát triển bất động sản": [
        "AAV",
        "AGG",
        "API",
        "ASM",
        "BII",
        "BVL",
        "C21",
        "CCI",
        "CCL",
        "CEO",
        "CLG",
        "CSC",
        "D11",
        "D2D",
        "DIG",
        "DRH",
        "DTA",
        "DXG",
        "EFI",
        "EIN",
        "FDC",
        "FIT",
        "HAR",
        "HD2",
        "HD6",
        "HDC",
        "HDG",
        "HLD",
        "HPI",
        "HPX",
        "HQC",
        "HTT",
        "HU6",
        "IDC",
        "IDJ",
        "IDV",
        "IJC",
        "ITA",
        "ITC",
        "KAC",
        "KBC",
        "KDH",
        "LDG",
        "LEC",
        "LGL",
        "LHG",
        "MH3",
        "NBB",
        "NDN",
        "NLG",
        "NRC",
        "NTB",
        "NTC",
        "NTL",
        "NVL",
        "NVT",
        "OGC",
        "PDR",
        "PFL",
        "PNT",
        "PPI",
        "PTL",
        "PV2",
        "PVL",
        "PXA",
        "PXL",
        "QCG",
        "RCL",
        "SCR",
        "SDU",
        "SJS",
        "SSH",
        "STL",
        "SZC",
        "SZL",
        "TDC",
        "TDH",
        "TEG",
        "TIG",
        "TIP",
        "TIX",
        "VC3",
        "VCR",
        "VHM",
        "VIC",
        "VNI",
        "VPH",
        "VRC",
        "VRG"
    ],
    "Công ty bảo hiểm": [
        "ABI",
        "AIC",
        "BHI",
        "BIC",
        "BLI",
        "BMI",
        "BVH",
        "MIG",
        "PGI",
        "PTI",
        "VNR"
    ],
    "Công ty Chứng khoán": [
        "AAS",
        "ABW",
        "AGR",
        "APG",
        "APS",
        "ART",
        "BMS",
        "BSI",
        "BVS",
        "CSI",
        "CTS",
        "DSC",
        "EVS",
        "FTS",
        "HAC",
        "HBS",
        "HCM",
        "IVS",
        "MBS",
        "ORS",
        "PHS",
        "PSI",
        "SBS",
        "SHS",
        "SSI",
        "TCI",
        "TVB",
        "TVS",
        "VCI",
        "VDS",
        "VFS",
        "VIG",
        "VIX",
        "VND",
        "VUA",
        "WSS"
    ],
    "Dịch vụ bất động sản": [
        "BCM",
        "CIG",
        "CKG",
        "CRE",
        "DLG",
        "DLR",
        "DTI",
        "DXS",
        "FIR",
        "FLC",
        "HD8",
        "HRB",
        "KHG",
        "KOS",
        "KSF",
        "LAI",
        "LSG",
        "MGR",
        "PLA",
        "PVR",
        "PWA",
        "SGR",
        "SIP",
        "SNZ",
        "SZG",
        "TBH",
        "TBR",
        "TCH",
        "THD",
        "TN1",
        "VHG",
        "VPI",
        "VRE"
    ],
    "Dịch vụ tài chính": [
        "BCG",
        "IBC",
        "IPA",
        "TGG",
        "TIN"
    ],
    "Ngân hàng": [
        "ABB",
        "ACB",
        "BAB",
        "BID",
        "BVB",
        "CTG",
        "EIB",
        "EVF",
        "HDB",
        "KLB",
        "LPB",
        "MBB",
        "MSB",
        "NAB",
        "NVB",
        "OCB",
        "PGB",
        "SGB",
        "SHB",
        "SSB",
        "STB",
        "TCB",
        "TPB",
        "VAB",
        "VBB",
        "VCB",
        "VIB",
        "VPB"
    ],
    "Quản lý tài sản": [
        "TVC"
    ],
    "Quỹ đóng": [
        "FUCTVGF3",
        "FUCTVGF4",
        "FUCVREIT",
        "FUEDCMID",
        "FUEKIVFS"
    ],
    "Quỹ mở": [
        "E1VFVN30",
        "FUEFCV50",
        "FUEIP100",
        "FUEKIV30",
        "FUEMAV30",
        "FUEMAVND",
        "FUESSV30",
        "FUESSV50",
        "FUESSVFL",
        "FUEVFVND",
        "FUEVN100"
    ],
    "Tái bảo hiểm": [
        "PRE"
    ],
    "Giấy": [
        "DHC",
        "GVT",
        "HAP",
        "HHP",
        "SVI",
        "SVT",
        "VID"
    ],
    "Hóa chất chuyên dụng": [
        "BFC",
        "BT1",
        "CPC",
        "DCM",
        "DHB",
        "DOC",
        "DPM",
        "HAI",
        "HSI",
        "HVT",
        "LAS",
        "NFC",
        "PMB",
        "PSE",
        "PSW",
        "QBS",
        "SFG",
        "SPC",
        "SVG",
        "TSC",
        "VAF",
        "VFG",
        "VPS"
    ],
    "Hóa chất cơ bản - Sản phẩm nhựa, cao su, hóa chất": [
        "AAA",
        "ABS",
        "APC",
        "APH",
        "APP",
        "BMP",
        "BRC",
        "BRR",
        "CSV",
        "DAG",
        "DDV",
        "DGC",
        "DPR",
        "DRG",
        "DRI",
        "DTT",
        "GER",
        "GVR",
        "HCD",
        "HII",
        "HNP",
        "HPH",
        "HRC",
        "IRC",
        "LNC",
        "LTG",
        "NHH",
        "NSG",
        "NTP",
        "PCE",
        "PCH",
        "PGN",
        "PHR",
        "PLC",
        "PLP",
        "RBC",
        "RDP",
        "RTB",
        "SBR",
        "SBV",
        "SIV",
        "TDP",
        "TNC",
        "TPC",
        "TPP",
        "TRC",
        "VKP",
        "VNP",
        "VTZ"
    ],
    "Khai khoáng chung": [
        "ACM",
        "AMC",
        "ATG",
        "BGM",
        "BKC",
        "BMC",
        "BMJ",
        "CBI",
        "CMI",
        "DHM",
        "FCM",
        "HGM",
        "HPM",
        "KCB",
        "KHD",
        "KSB",
        "KSH",
        "KSQ",
        "KSV",
        "LCM",
        "LMC",
        "MGC",
        "MIC",
        "MIM",
        "MSR",
        "MTA",
        "PAT",
        "SQC",
        "TNT",
        "VBG",
        "VCE",
        "VIM",
        "VPG",
        "YBM"
    ],
    "Khai thác than": [
        "BCB",
        "CLM",
        "CST",
        "HLC",
        "MDC",
        "MVB",
        "NBC",
        "TC6",
        "TDN",
        "THT",
        "TMB",
        "TVD",
        "VDB"
    ],
    "Khai thác vàng": [
        "GLC"
    ],
    "Kim loại màu": [
        "CKA",
        "CKD",
        "DFC",
        "HLA",
        "HMC",
        "HSV",
        "KLM",
        "PAS",
        "PEC",
        "SHA",
        "TKG",
        "TKU",
        "VGL"
    ],
    "Nhôm": [
        "NSH"
    ],
    "Thép": [
        "BCA",
        "BVG",
        "DTL",
        "HMG",
        "HPG",
        "HSG",
        "ITQ",
        "KKC",
        "KMT",
        "KVC",
        "MEL",
        "NKG",
        "POM",
        "SMC",
        "SSM",
        "TDS",
        "TIS",
        "TLH",
        "TMG",
        "TNB",
        "TNS",
        "TTS",
        "TVN",
        "VCA",
        "VDT",
        "VGS"
    ],
    "Trồng rừng, khai thác gỗ và kinh doanh lâm sản": [
        "BKG",
        "CAP",
        "FRC",
        "FRM",
        "MDF",
        "PIS",
        "PRT",
        "TQN",
        "VIF",
        "VTQ"
    ],
    "Viễn thông cố định": [
        "CTR",
        "FOC",
        "FOX"
    ],
    "Viễn thông di động": [
        "ABC",
        "TTN"
    ],
    "Các nhà cung cấp dịch vụ y tế": [
        "TNH",
        "TTD"
    ],
    "Công nghệ sinh học": [
        "VNY",
        "VXP"
    ],
    "Dược phẩm": [
        "AGP",
        "BCP",
        "BIO",
        "CDP",
        "CNC",
        "DBD",
        "DBM",
        "DBT",
        "DCL",
        "DDN",
        "DHD",
        "DHG",
        "DHN",
        "DHT",
        "DMC",
        "DP1",
        "DP2",
        "DP3",
        "DPH",
        "DPP",
        "DTG",
        "DTH",
        "DTP",
        "DVM",
        "DVN",
        "HDP",
        "IMP",
        "LDP",
        "MED",
        "MKP",
        "MKV",
        "MTP",
        "NDC",
        "NDP",
        "NTF",
        "OPC",
        "PBC",
        "PMC",
        "PPP",
        "SPM",
        "TRA",
        "TVP",
        "TW3",
        "UPH",
        "VDP",
        "VET",
        "VMD",
        "YTC"
    ],
    "Trang thiết bị y tế": [
        "AMP",
        "AMV",
        "JVC",
        "MEF"
    ],
    "Vật tư y tế": [
        "BBT",
        "MRF"
    ]
}

        for ogan_code in vn_codes:
            from_date = "2000-10-20"
            to_date = "2023-08-26"
            url = f'https://technical.fiintrade.vn/TradingView/GetIndicators?language=vi&OganCode={ogan_code}&Code={code}&Frequency=Daily&From={from_date}&To={to_date}'

            headers = {
                "Accept": "application/json, text/plain, */*",
                "Accept-Language": "vi-VN,vi;q=0.9,en-US;q=0.8,en;q=0.7",
                "Authorization": "Bearer",
                "Connection": "keep-alive",
                "Origin": "https://fiintrade.vn",
                "Referer": "https://fiintrade.vn/",
                "Sec-Fetch-Dest": "empty",
                "Sec-Fetch-Mode": "cors",
                "Sec-Fetch-Site": "same-site",
                "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
                "sec-ch-ua": "\"Not.A/Brand\";v=\"8\", \"Chromium\";v=\"114\", \"Google Chrome\";v=\"114\"",
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": "\"macOS\""
            }
            file_name = code + "_" + self.convert_vietnamese(ogan_code).replace(" ", "_").replace(",", "")
            yield scrapy.Request(
                url=url,
                method='GET',
                dont_filter=True,
                headers=headers,
                callback=self.parse,
                cb_kwargs=dict(ticker=ogan_code, file_name=file_name)
            )

    def parse(self, response, **kwargs):
        data = json.loads(response.text)
        items = data.get("items", [])
        input_format = '%Y-%m-%dT%H:%M:%S'
        output_format = '%m/%d/%Y'
        ticker = kwargs.get("ticker", "")
        file_name = kwargs.get("file_name", "")
        for item in items:
            parsed_date = datetime.strptime(item.get("tradingDate"), input_format)
            formatted_date = parsed_date.strftime(output_format)
            data_item = FinnTradeItem(
                date=formatted_date,
                value=item.get("openPrice"),
                ticker=ticker,
                file_name=file_name,
            )
            yield data_item

    def convert_vietnamese(self, text: str) -> str:
        """
        Convert from 'Tieng Viet co dau' thanh 'Tieng Viet khong dau'
        text: input string to be converted
        Return: string converted
        """
        patterns = {
            '[àáảãạăắằẵặẳâầấậẫẩ]': 'a',
            '[đ]': 'd',
            '[èéẻẽẹêềếểễệ]': 'e',
            '[ìíỉĩị]': 'i',
            '[òóỏõọôồốổỗộơờớởỡợ]': 'o',
            '[ùúủũụưừứửữự]': 'u',
            '[ỳýỷỹỵ]': 'y'
        }
        output = text
        for regex, replace in patterns.items():
            output = re.sub(regex, replace, output)
            # deal with upper case
            output = re.sub(regex.upper(), replace.upper(), output)
        return output



